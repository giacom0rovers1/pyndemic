% Giacomo Roversi - Remote Sensing
%\documentclass[DIV=14, paper=a4, fontsize=10pt]{scrartcl}
\documentclass[DIV=12, BCOR=0pt]{scrartcl}  % A4 paper and 11pt font size {scrartcl}
\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}
%\usepackage[default]{raleway}
\usepackage[default]{cantarell}
\usepackage[cm]{sfmath}
\usepackage{amsmath}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage[round]{natbib}
\usepackage{tabu}
\usepackage{booktabs} % \toprule \midrule \bottomrule
\usepackage{physics}
\usepackage{siunitx}
\usepackage{eurosym}
\usepackage{graphicx}

\usepackage{esdiff}
\usepackage{xfrac}

\definecolor{linkcolour}{rgb}{0,0.2,0.6}
\hypersetup{colorlinks,breaklinks,urlcolor=linkcolour,linkcolor=linkcolour}  


\begin{document}
%	
%	\begin{flushright}
%	% Author	
%	{\large Giacomo Roversi} \\ 
%	{\small \href{mailto:giacomo.roversi2@studio.unibo.it}{giacomo.roversi2@studio.unibo.it} }\\
%	\vskip0.2in
%  % Date
%  {\large November 12, 2020}
%	\end{flushright}
%
%	\begin{flushleft}
%	\vskip0.2in
%	% Title
%	{\huge \textbf{Numerical simulations of influenza-like epidemic processes over complex networks}} 
%	\vskip0.2in
%	% Subtitle
%	{\Large \color{gray}
%	Reti complesse A.A. 2017-2018  \\
%	Università di Bologna - Laurea Magistrale in Fisica del Sistema Terra}
%	\end{flushleft}



\begin{flushright}
	% Author	
	{\large Giacomo Roversi} \\ 
	{\small \href{mailto:giacomo.roversi2@studio.unibo.it}{giacomo.roversi2@studio.unibo.it} }\\
	\vskip0.15in
	% Date
	{\large November 16, 2020}
\end{flushright}

\begin{flushleft}
	% 
	{\Large \color{gray}
		Reti complesse A.A. 2017-2018 - Prof. Daniel Remondini  \\
		Università di Bologna - Laurea Magistrale in Fisica del Sistema Terra}


	\vskip0.2in
	% Title
	{\huge\textbf{Numerical simulations of influenza-like epidemic processes over complex networks}} 
	\vskip0.33in
	
\end{flushleft}
%	\section*{Abstract}
	
	\section{Introduction}
	\label{sec:intro}
	This work is based on \citet{Pastor-Satorras} %  Pastor-Satorras et al. (2015) 
	and aims to analyse numerically a series of contagion scenarios, inspired to the current COVID-19 pandemic, over a complex network of the human interaction patterns. 
 	Theoretical fundamentals and deterministic predictions of the SIR and SEIR models are firstly presented. These predictions are then compared with discrete-time numerical simulations over complex networks, carried out in python exploiting the \textit{NetworkX} and \textit{NDlib} libraries. The networks are chosen to show different aspects of the contagion dynamics, going from a random network to a clustered-scale-free one in progressive steps of realism and resemblance to the real human interaction networks. 
 	Finally, some mitigation and immunization strategies are tested.
  
  
  
  
  \section{The SIR epidemic model}
  The SIR model divides the population into three compartments: susceptible ($S$), infected ($I$) and removed ($R$), the latter meaning either recovered and immune or deceased. Its basic implementation assumes no vital dynamics (closed population, no births or deaths in the $S$ compartment) and homogeneous mixing (completely random interactions). Under this assumptions the transitions between compartments are regulated by a set of deterministic differential equations following the mass-action law. Calling $s = \sfrac{S}{N}$, $i = \sfrac{I}{N}$ and $r = \sfrac{R}{N}$ the relative populations of the three compartments, the differential equations read:
  
  \begin{align}
  	\diff{s}{t} = - \beta s i \quad;  \qquad 	\diff{i}{t} = \beta s i - \mu r \quad; \qquad  \diff{r}{t} = \mu r
  \end{align}
  
  The conservation of the total population, fixed at 10.000 individuals, is always granted: %$\quad s + i + r = 1 \ \ ; \quad \sfrac{\mathrm{d}N}{\mathrm{d}t}= 0$. \\
  \begin{align}
  	s + i + r = 1 \quad ; \qquad \diff{N}{t}= 0
  \end{align}
  The coefficients $\beta$ and $\mu$ are the transition rates of two Poisson processes, i.e. with independent exponentially distributed events. The ratio between them is the basic reproduction number $R_{0}$, which is the total number of secondary infections generated on average by one infected individual.   
  The average time during which an individual can spread the contagion is $\tau_{r} = \sfrac{1}{\mu}$. The infection rate $\beta$ could be seen as the probability of a contagion event in a single time interval. Thus $R_{0}$ is the product of the probability of one infected individual to infect one susceptible times the duration of the contagious condition.
  \begin{align}
			R_{0} = \frac{\beta}{\mu} = \beta \cdot \tau_{r}
  \end{align}
  
  The condition for an epidemic to develop is that, given an initial small fraction of infected individuals ($i \approx 0.1 \%$), the time derivative of $i$ needs to be greater than zero:
  \begin{align}
  	\diff{i}{t} = \beta s i - \mu r > 0 \qquad \Rightarrow \quad 	\frac{\beta}{\mu} > 1  % \mathrm{This \ requires:}
  \end{align}
  
  Thus the contagion is going to spread if $R_{0}$ is greater than one. The values of the transition rates are kept constant throughout the various simulations: $\beta = 0.22 \ d^{-1}$ and $\mu = 0.1 \ d^{-1}$, resulting in $R_{0} = 2.2$. The unit $d$ indicates "days", the simulation time step is $1 \ d$.
  
  % TODO dichiarare i parametri utilizzati (cfr. studi COVID19)
  
  \subsection{The exponential growth}
  
  \begin{figure}[h!]
  	\centering
  	\includegraphics[width=0.7\linewidth]{../immagini/SIR_03.png}
  	\caption{Exponential growth in the initial phase of an epidemic. }
  	\label{fig:SIRexp}
  \end{figure}
  
  In the initial phase, $s(t)$ could be approximated to one. % and the time before recovery to infinite ($\mu$ very small). 
  Under this assumption the evolution of the infected population $i(t)$ becomes purely exponential:
  \begin{align}
  	\diff{i}{t} \approx  \beta i \qquad \Rightarrow \quad 	i(t) \approx i(0) \cdot e^{K_{0} t} \qquad \mathrm{with} \qquad K_{0} = (\beta - \mu)
  \end{align}
	
	Besides the initial growth rate $K_{0}$, the exponential description could also be made through either the doubling time $T_{d}$, or the basic reproduction number itself:
	% in which case it becomes: $\ i(t) \approx i(0) \cdot 2^{\sfrac{t}{T_{d}}}$, : $\ i(t) \approx i(0) \cdot R_{0}^{\sfrac{t}{\tau_{s}}}$.
	\begin{align}
		\ i(t) \approx i(0) \cdot 2^{\sfrac{t}{T_{d}}} \quad ; \qquad i(t) \approx i(0) \cdot R_{0}^{\sfrac{t}{\tau_{s}}}
	\end{align}
%	 where $\tau_{s}$ is the serial interval, i.e. the average time of a complete iteration of the infection process .
	
	In the latter, the serial interval $\tau_{s}$ represents the average time elapsed during one complete iteration of the infection chain process (i.e. from a generation $A$ to the generation $B$ of secondary infections produced by $A$) and it is estimated from $R_{0}$ and $K_{0}$: 
	\begin{align}
		\tau_{s} = \frac{\ln(R_{0})}{K_{0}}
	\end{align}

	The initial growth rate $K_{0}$ could be estimated through the exponential fit of the positives curve $i(t)$ in the initial phase of the epidemic, as shown in Fig. \ref{fig:SIRexp}. The initial part is arbitrarily selected to end at $\sfrac{1}{6}$ of the curve's maximum (epidemic peak), or to include at least 5 readings. From the fit results a growth rate $K_{0}$ of $0.11 \ d^{-1}$, which corresponds to a doubling time $T_{d}$ of $6.07 \ d$ and, given a reproduction number of $2.2$, to a serial interval $\tau_{s}$ of $6.9 \ d$.

  \subsection{The evolution of the epidemic}
  
  \begin{figure}[h!]
  	\centering
  	\includegraphics[width=0.7\linewidth]{../immagini/SIR_02.png}
%  	\includegraphics[width=0.49\linewidth]{../immagini/SIR_02.png}
%  	\includegraphics[width=0.49\linewidth]{../immagini/SIR_04.png}
  	\caption{Typical evolution of a SIR model. }
  	\label{fig:SIRtot}
  \end{figure}

  As the epidemic grows, the depletion of susceptible individuals is no longer negligible and the reduction of the number of available candidates slows down the contagion. The number of simultaneously infected individuals reaches a peak and, from there on, becomes exponentially smaller and eventually dies out.
  
  The evolution shown in Fig. \ref{fig:SIRtot} %, left panel, 
  is obtained integrating the differential equations of the model with the \textit{SciPy} python library, starting from an initially infected population of $0.1 \%$ (10 individuals). The infectious peak is near $2000$ individuals simultaneously infected ($20 \%$ of the total population), and after $200 \ d$ the total population interested by the infection surpasses $80 \%$. The infected population after $200 \ d$ is almost zero. \\
	%  The duration of the infection (the average time passing from the symptoms to the recovery or death) is $\tau_{r} = \sfrac{1}{\mu}$, while the incubation period is $\tau_{i}=\sfrac{1}{\gamma}$.
  
  %Here introduced metric / framework for following analysis with networks
  
  %Initial numerical instability, then Rt follows the prediction, then numerical instability again
  
  %(mettere dopo, a confronto con SEIR, in una figura 2x2)
 	
% \begin{figure}[h]
%   \centering
%   \includegraphics[width=0.75\linewidth]{../immagini/SIR_04.png}
%   \caption{Exponential growth in the initial phase of an epidemic. }
%   \label{fig:SIRr0}
% \end{figure}
%  
  % TODO Metodi per calcolare R e K istante per istante
  
  % TODO Popolazione finale infettata
  
  
  
  
  
  
  \section{The SEIR epidemic model}
  For modelling the spread of an influenza-like epidemic like COVID-19 the SEIR model (Susceptible, Exposed, Infect(ive), Removed) is more suited (girare!), since it provides both immunization after the infective phase (as is currently believed for the corona virus) and an incubation phase. 
  
 $e = \sfrac{E}{N}$,  the differential equations read:
  
  \begin{align}
  	\diff{s}{t} = - \beta s i \quad;  \qquad 	\diff{e}{t} = \beta s i - \gamma e \quad; \qquad \diff{i}{t} = \gamma e - \mu r \quad; \qquad \diff{r}{t} = \mu r
  \end{align}
  
  while again the total population is conserved: $s + e + i + r = 1$.
  
 The incubation period is $\tau_{i}=\frac{1}{\gamma}$. The serial interval is given by the incubation time plus the time before recovery/removal 
 
 R0 is 
  

  
  Parameters are computed (R0, $K_{0}$, describe...)
  
  The exponential growth is evaluated for the total positives which means the combination of the Exposed and Infected classes together. The growth is slower due to the delay added by the incubation period.
  
  
  \begin{figure}[h]
  	\centering
  	\includegraphics[width=0.75\linewidth]{../immagini/SEIR_02.png}
  	\caption{}
  	\label{}
  \end{figure}
  
  \section{Complex networks}
  Translate: \textit{L'assunzione di omogeneita` e` sicuramente inadeguata per sistemi reali che presentano forte eterogeneita` di composizione e di rapporti relazionali. Si affronta la modellizzazione di questa eterogeneita` relazionale tramite reti complesse sulle quali riprodurre i modelli di contagio per step di interazione individuo-individuo discretizzati. In una rappresentazione discreta su network, i parametri del modello acquisiscono il valore di probabilita` di transizione (quindi su reti piccole si evidenzia l'effetto di fluttuazioni random, necessario approccio ensemble).  }
  
  Homogeneous mixing hypothesis is certainly inadequate for modelling real systems, which show heterogeneity of composition and relationship spanning various scales. 
  
  
  Approach: recreate the same analysis work flow of the deterministic model
  Nodes = individuals, links = way of interaction (contagion)
  
  The deterministic prediction works as mean field approximation?
  
  Here $\beta$ is the contagion probability for a single interaction ($\xi$) times the average number of interactions which is given by the average connectivity degree $<k>$ of the network. The $<k>$ and $\xi$ parameters are chosen in such a way that $\beta$, hence $R_{0}$, is kept constant and equal to the deterministic infection rate. This is done to allow cross-network intercomparison. Given that the average connectivity is considered, for heterogeneous networks there could locally be major fluctuations from the average behaviour.
  
  
  Initial 10 infected nodes chosen at random (further work: ensemble)
  
  \subsection{Random network}
  Erdos Renyi
  Contagion on random network evolves similarly to the deterministic ODE problem. 
  
  Smoothing of the positives (Exposed + Infected) curve is needed to avoid contamination from numerical and most importantly network noise. 
  
  Network noise is strictly linked to the random nature of the network, locally there are deviations from the average connectivity which make the epidemic evolve ad different speeds
  
  
  \subsection{Lattice}
  Ring
  The contagion is strongly inhibited, starts exponentially slower than the rest, Rt(0) most similar to predicted R0,
  then stops (no, oscillates around R=1, still going) with plenty of susceptible nodes still available but not reachable. Try with more days.
  
  
  \subsection{Small-World}
  Watts Strogatz
  Starts similar to lattice, evolves similar to random. GOOD
  
  \subsection{Scale free}
  Barabasi-Albert
  Initial boost is the fastest, $K_{0}=0.006$ and Td is less than 12 days. Look at the degree structure..
  
  
  \subsection{Scale free with clustering}
  Holme-Kim
  The initial growth is almost exponential and $K_{0}$ is high but after that the pandemic slows down extremely fast
  
  
  
  
  
  
  \section{Immunization and mitigation strategies}
  \subsection{Lockdown and quarantine}
  \subsection{Vaccines}
  \subsubsection{Random (failure)}
	\subsubsection{Targeted (attack)}

	\section{Conclusions}

		
%  \small
  \footnotesize
	\bibliographystyle{plainnat} %  % apalike
	% Apalike non mostra i DOI, plainnat o abbrvnat mettono i nomi prima dei cognomi
	\bibliography{networks}

\end{document}



%%% Vademecum %%%
Bibliography:
\bibliographystyle{plainnat} %  % apalike
% Apalike non mostra i DOI, plainnat o abbrvnat mettono i nomi prima dei cognomi
\bibliography{networks}

Citations:
\citep{bibid}
\citet{bibid}

Math expressions:
\begin{align}
	a = b
\end{align}

Tables:
\begin{table}[h]
	\centering
	\begin{tabu} to \textwidth {X[1,l]X[1,c]X[1,c]X[1,c]} 
		\toprule
		Product & Reference  & Latency  & Spatial \\
		&time step (min)  &  (min)  &   resolution (km) \\ 
		\midrule
		CML & 15 &20 & 5 \\
		Radar raw & 5 & 15 & 1 \\
		Radar adj. & 60 & 60 &  1 \\
		Raingauges raw & 60 & 60 &  - \\
		ERG5 & 60 & 1440 & 5 \\ 
		\bottomrule
	\end{tabu}
	\caption{Latency and spatial and temporal sampling of the considered precipitation products.}
	\label{tab:latency}
\end{table}

Figures:
\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.75\linewidth]{../Es01/immagini/dati4.png}
	\caption{Portate in funzione dei tiranti per le 4 campagne di misura, con incertezze al 25\%.}
	\label{fig:dati}
\end{figure}
