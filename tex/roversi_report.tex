% Giacomo Roversi - Remote Sensing
%\documentclass[DIV=14, paper=a4, fontsize=10pt]{scrartcl}
\documentclass[DIV=12, BCOR=0pt]{scrartcl}  % A4 paper and 11pt font size {scrartcl}
\usepackage[utf8x]{inputenc}
\usepackage[english]{babel}
%\usepackage[default]{raleway}
\usepackage[default]{cantarell}
\usepackage[cm]{sfmath}
\usepackage{amsmath}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{hyperref}
\usepackage[round]{natbib}
\usepackage{tabu}
\usepackage{booktabs} % for \toprule \midrule \bottomrule
\usepackage{physics}
\usepackage{siunitx}
\usepackage{eurosym}
\usepackage{graphicx}

\usepackage{esdiff}
\usepackage{xfrac}


\graphicspath{ {../immagini/} } % aggiornare una volta definitive % 08_beforeLastFixes/
\definecolor{linkcolour}{rgb}{0,0.2,0.6}
\hypersetup{colorlinks,breaklinks,urlcolor=linkcolour,linkcolor=linkcolour}  


\begin{document}
%	
%	\begin{flushright}
%	% Author	
%	{\large Giacomo Roversi} \\ 
%	{\small \href{mailto:giacomo.roversi2@studio.unibo.it}{giacomo.roversi2@studio.unibo.it} }\\
%	\vskip0.2in
%  % Date
%  {\large November 12, 2020}
%	\end{flushright}
%
%	\begin{flushleft}
%	\vskip0.2in
%	% Title
%	{\huge \textbf{Numerical simulations of influenza-like epidemic processes over complex networks}} 
%	\vskip0.2in
%	% Subtitle
%	{\Large \color{gray}
%	Reti complesse A.A. 2017-2018  \\
%	Università di Bologna - Laurea Magistrale in Fisica del Sistema Terra}
%	\end{flushleft}



\begin{flushright}
	% Author	
	{\large Giacomo Roversi} \\ 
	{\small \href{mailto:giacomo.roversi2@studio.unibo.it}{giacomo.roversi2@studio.unibo.it} }\\
	\vskip0.15in
	% Date
	{\large November 16, 2020}
\end{flushright}

\begin{flushleft}
	% 
	{\Large \color{gray}
		Reti complesse A.A. 2017-2018 - Prof. Daniel Remondini  \\
		Università di Bologna - Laurea Magistrale in Fisica del Sistema Terra}


	\vskip0.2in
	% Title
	{\huge\textbf{Numerical simulations of epidemic processes in complex networks}} 
	\vskip0.33in
	
\end{flushleft}
%	\section*{Abstract}
	
	\section*{Introduction}
	\label{sec:intro}
	This work studies and compares a series of idealized contagion scenarios, simulated over different unweighted undirected static random networks resembling human-to-human interactions. It is inspired by the current worldwide effort in containing the COVID-19 pandemic and follows mainly \citet{PastorSatorras} and \citep{Firth2020}.
	
 	In the first section I will present the fundamental differential equations and the deterministic numerical solutions of the SIR and SEIR models. I will then compare the deterministic predictions with the results of discrete-time simulations over various random networks. The networks share the same size and average connectivity, but differ in clustering and degree distribution, allowing a progression from simple models to more realistic and complex ones, to show different aspects of the contagion dynamics. The simulations are carried out in Python 3, exploiting the \textit{NetworkX} and \textit{NDlib} libraries, which are integrated in a specific framework crafted for the occasion. % \citep{pyndemic}. 
 	Finally, I will implement and discuss some mitigation strategies.
  
  \section{Epidemic models}
  \label{sec:theory}
	The mathematical modelling of epidemic spreading in a specific population generally assumes that the population could be divided into different classes or compartments depending on the stage of the disease.
	Stochastic reaction-diffusion processes control the transitions among these compartments. 
	The spreading of the contagion follows the mass-action law, i.e. the force of the infection is proportional to the fraction of infected individual in the population.
	
  The homogeneous mixing hypothesis assumes that individuals in a population are well mixed, indistinguishable, and interact with members of the other compartments completely at random.
  Under this assumption, likewise under a mean-field approximation from statistical physics, full information about the state of the epidemic is encoded in the relative populations of the different compartments and a deterministic approach with differential equations is possible. Two models, SIR and SEIR, which differ in the number of compartments, are presented below.
   
  \subsection{The SIR epidemic model}
  
  \begin{figure}[h]
  	\centering
  	\includegraphics[width=0.6\linewidth]{SIR_02.png}
  	\caption{The complete development of the SIR model starting with $0.1\%$ infected population.}
  	\label{fig:SIRtot}
  \end{figure}

  The SIR model divides the population into three compartments: susceptible ($S$), infected or - more appropriately - "infecting" ($I$) and removed ($R$), the latter meaning either recovered (and immune), hospitalized, self quarantined, deceased or any other situation where the contagion chain develops no further. Its basic implementation assumes no demographic effects (closed population, no births or deaths in the $S$ compartment) and homogeneous mixing. Under this assumptions the transitions between compartments are regulated by a set of deterministic differential equations. % following the mass-action law.
  Calling $N$ the total population, the relative population fractions of the 3 compartments are:
  \begin{align}
			s = \frac{S}{N}  \quad;  \qquad 	 i = \frac{I}{N}  \quad;  \qquad 	 r = \frac{R}{N}
  \end{align}

  The fundamental differential equations of the SIR model read:
  \begin{align}
  	\diff{s}{t} = - \lambda s i \quad;  \qquad 	\diff{i}{t} = \lambda s i - \mu i \quad; \qquad  \diff{r}{t} = \mu i
  	\label{eq:sir}
  \end{align}

  The total population $N$ is conserved (it's a closed system with no births nor deaths):  
  \begin{align}
  	s + i + r = 1 \quad ; \qquad \diff{s}{t} + \diff{i}{t} + \diff{r}{t} = 0  \quad ; \qquad  \diff{N}{t}= 0
  	\label{eq:sir_sum}
  \end{align}

	The coefficients $\lambda$ and $\mu$ are the transition rates of two Poisson processes, i.e. with independent, exponentially distributed events. The ratio between them is called the basic reproduction number $R_0$, which is the expected total number of secondary infections generated by one infected individual, given a totally susceptible population ($s=1$). 
	
	The transition rate $\lambda$ is the product of the average probability of transmission during a single contact ($\beta$) and the average number of expected contacts per individual ($\bar{k}$)\footnote{The definition for $\lambda$ departs from the \citet{PastorSatorras} notation. Here $\lambda = \beta \bar{k}$, not $\lambda = \sfrac{\beta}{\mu}$.}.
  The average time during which an individual can spread the contagion is $\tau_{r} = \sfrac{1}{\mu}$, thus $R_0$ is also the product of the infection probability and the duration of the contagious state. 
  \begin{align}
			R_0 = \frac{\lambda}{\mu} \ \equiv \ \frac{\beta \bar{k}}{\mu} \ \equiv \ \beta \bar{k} \tau_{r}
			\label{eq:R0}
  \end{align}

  \subsubsection{The initial growth}
  The condition for an epidemic to develop is that, given an initial small fraction of infected individuals, their number increases in time, i.e. the time derivative of $i$ is greater than zero:
  \begin{align}
  	\diff{i}{t} = \lambda s i - \mu i \quad > \ 0 
  	\label{sir_growthCond}
  \end{align}
  \begin{align} % \qquad \Rightarrow \quad 	
  	\frac{\beta \bar{k} }{\mu} \cdot s \ > \ 1  % \mathrm{This \ requires:}
  	\label{eq:sir_growthReq}
  \end{align}
  
  Thus, for a completely susceptible population ($s \approx 1$), the contagion is going to spread if $R_0$ is greater than one. In the initial phase, $s( t \! = \! 0)$ could be approximated to the constant $s_0$.
  Under this assumption the evolution of the infected population $i(t)$ becomes purely exponential:
  \begin{align}
  	\diff*{i}{t}{t=0} \approx \quad (\lambda s_0 - \mu) \cdot i 
  	\label{eq:sir_approxi}
  \end{align}
  \begin{align} % \qquad \Rightarrow \quad 	
  	i(t) \ \approx \ i(0) \cdot e^{K_0 t} 
  	\label{eq:sir_growthK0}
  \end{align}
  
 where $K_0$ is the initial growth rate:
 \begin{align} % \qquad  \mathrm{with} \qquad 
 	K_0 = (\lambda s_0 - \mu)
 	\label{eq:sir_K0}
 \end{align}
 
 The exponential growth could also be described in terms of the doubling time (which is the constant time interval after which the population has doubled):
	\begin{align}
		T_{d} = \frac{\ln 2}{K_0}
		\label{eq:doubling} 
	\end{align}
	\begin{align}
		i(t) \ \approx \ i(0) \cdot 2^{\sfrac{t}{T_{d}}}
		\label{eq:sir_growthTd} 
	\end{align}

	Or it could rather be described with the basic reproduction number $R_0$ itself:
	\begin{align}
		i(t) \ \approx \ i(0) \cdot R_0^{\sfrac{t}{\tau_s}}
		\label{eq:sir_growthR0}
	\end{align}

	The serial interval $\tau_s$ is defined from \citet{Du2020} as the average time duration between a primary case-patient having symptom onset and a secondary case-patient having symptom onset following the infection received by the first one (i.e. the time between two generation of infected individuals) and it is here estimated from $R_0$ and $K_0$, since no real clinical data was analysed: 
	\begin{align}
		\tau_s = \frac{\ln(R_0)}{K_0}
		\label{eq:serial}
	\end{align}

	I will consider both the basic reproduction number and the serial interval as general parameters of the simulated infectious phenomenon and I will not change them through the epidemic. Real-life, pandemic-scale events are clearly more heterogeneous (different immune responses, symptoms, healthcare systems, pathogen strains after mutations, and so on) and those parameters should be estimated from statistical analyses on real clinical data.  

  \subsubsection{The evolution of the epidemic}
  As the epidemic grows, the depletion of susceptible individuals is no longer negligible and the reduction of the number of available candidates slows the contagion down.
  The effective reproduction number $R(t)$ follows the evolution of the susceptible population fraction $s(t)$ and represents the remaining strength of the contagion:
  \begin{align}
		R(t) = R_0 \cdot s(t) 
		\label{eq:Rt}
  \end{align}

  When the value of $R(t)$ reaches $1$, the number of simultaneously infected individuals $i(t)$ is at its peak. From there on, it becomes exponentially smaller as the force of the infection lowers with both $i$ and $s$ and eventually dies out: the epidemic has ended.
  
  The instantaneous growth rate $K(t)$ follows the curve of the positive population:
  \begin{align}
  	K(t) =  \diff{}{t} \ln(i(t)) = \frac{1}{i(t)} \diff{}{t} i(t)
  	\label{eq:Kt}
  \end{align}

	Knowing the instantaneous growth rate and having defined a constant serial interval $\tau_s$ from the initial phase, it is possible to obtain a direct estimate of the daily value of $R(t)$ combining Eq. \ref{eq:sir_growthK0} and Eq. \ref{eq:sir_growthR0}. This estimate will be independent from Eq. \ref{eq:Rt} and will follow the actual evolution of the spreading:

  \begin{align}
  	R_K(t) = e^{K(t) \cdot \tau_s}
  	\label{eq:RKt}
  \end{align}

	But, since they virtually measure the same quantity, $R(t)$ and $R_K(t)$ should be comparable. If they are not, the assumptions on which $R_0$ is based are called into question.
  % TODO quali sono?????
  
  \subsection{The SEIR epidemic model}
  The SEIR model adds the exposed (E) compartment to the picture. Compartment E includes individuals who have already been infected but are not yet contagious (hence the more appropriateness of calling "infecting" the I compartment). The presence of the incubation phase makes this model more suitable for modelling the spread of an influenza-like disease like COVID-19. 
  
  Calling $e = \sfrac{E}{N}$ the new compartment's relative population, the differential equations of the model now read:
  
  \begin{align}
  	\diff{s}{t} = - \lambda s i \quad;  \qquad 	\diff{e}{t} = \lambda s i - \gamma e \quad; \qquad \diff{i}{t} = \gamma e - \mu i \quad; \qquad \diff{r}{t} = \mu i
  	\label{eq:seir}
  \end{align}

  where $\gamma$ is the poissonian transition rate between the exposed and the infective compartments. The total population is again conserved: $ s + e + i + r = 1$.
  
  While the SIR model was governed by one single differential equation fot $i(t)$ (Eq. \ref{eq:sir_approxi}), the SEIR one needs a system of two equations for $e(t)$ and $i$.
  The system can be written in the form of a matrix operator applied to a vector. Determining the temporal evolution of the model is here an eigenvalue problem. Specifically, the initial growth problem with the $s(0) = s_0$ approximation reads as follows: 
  
  \begin{align}
  	\diff{}{t}
  	\begin{pmatrix}
  			e \\
  			i
  	\end{pmatrix}_{t=0}
  	\approx \
  	\begin{pmatrix}
  		 - \gamma & \lambda s_0\\
  		 \gamma & - \mu
  	\end{pmatrix}
  	\begin{pmatrix}
  		e \\
  		i
  	\end{pmatrix}
	  \quad = \quad K_0 %^{SEIR}
	  \begin{pmatrix}
	  	e \\
	  	i
	  \end{pmatrix} %> 0
		\label{eq:seir_approxi}
	\end{align}

The initial growth coefficient $K_0$ for the SEIR model is the bigger eigenvalue of the operator and it is obtained solving the equation: 

	\begin{align}
		\det 
		\begin{pmatrix}
			- \gamma - K_0 & \beta \bar{k} s_0\\ % ^{SEIR}
			\gamma & - \mu - K_0  %^{SEIR}
		\end{pmatrix} = 0
	\label{eq:seir_K0}
	\end{align}
 
 The initial evolution of the total positive population $p(t)$ still follows an exponential law identical to Eq. \ref{eq:sir_growthK0}.
%  given by: % $p(t) = e(t) + i(t)$ 
 \begin{align}
		p(t) = \ e(t) + i(t) \ \approx \  p(0) \cdot e^{K_0 t}
 \end{align}

%  But due to the incubation delay that is added to the dynamics of the infection, the other parameters being equal, the initial growth will be slower than in the SIR model.
 
	\section{Numerical integration}
	\label{sec:numerical}
	
  \subsection{Model configuration}
	The SIR and SEIR model are initialized with the same input parameters (obviously except $\gamma$). Among the initial population of 10 000 people, there are initially 10 infected and already contagious individuals ($i(t \! = \! 0) = 0.1 \%$).
	
	Epidemiological studies have identified that, for the SARS-CoV-2 infection, the incubation period is approximately $4$ to $5$ days \citep{Gandhi2020}, specifically $4.2 \ d$ according to \citet{Sanche2020}. The same study shows that, before awareness of the COVID-19 danger, the time from symptom onset to hospitalization was $5.5$ days, whereas after reports of potential human-to-human transmission, the duration shortened significantly to $1.5 \ d$. We can assume similar time scales for the self-quarantine measures. Since patients may be infectious $1$ to $3$ days before symptom onset \citep{Gandhi2020}, the actual model parameters should be shifted of that interval, being the model not about symptoms but infections. 
	
  The model is therefore initialized with three days removal period (population in "awareness mode") and three days incubation period. 
  The respective transition rates are both equal to $0.33 \ d^{-1}$ as shown in Tab. \ref{tab:params}. 
  The "non-awareness mode" with a removal period of seven days is addressed in Section \ref{sec:miti}, to stress the importance of the early hospitalization of patients. 
  \input{params.tex}
 
  % TODO verificare che fili dopo la modifica con beta k
  $\bar{k} = 12$ is chosen as a fair approximation of the average daily physical contacts which one individual probably experiences in real life, while the probability $\beta$ is fixed at $6.1 \%$. In this way, on average, the infection rate $\beta \bar{k}$ parameter is equal to $0.73 \ d^{-1}$ and the basic reproduction number $R_0$ is 2.20. The literature indicates values of $R_0$ between $2$ and $3.5$ for respiratory diseases transmitted over breath droplets like influenza, common cold or COVID-19 \citep{Hilton2020, Sanche2020, Firth2020}. 
  The number: $1 - \sfrac{1}{R_0} = 0.54 $ is the expected immune fraction needed to reach the "herd immunity" through vaccinations.
  
  The expected values of $K_0$, $T_d$ and $\tau_s$ are calculated directly with Eq. \ref{eq:seir_K0}, Eq. \ref{eq:doubling} and Eq. \ref{eq:serial} respectively and are presented in Tab. \ref{tab:props}. The SEIR initial doubling time is longer than the SIR one because of the delay added by the incubation phase, but both are very short. Given the reproduction number of $2.2$, the serial interval $\tau_s$ for the SEIR model results $4.90 \ d$ from Eq. \ref{eq:serial}. This value will be kept as reference serial interval for the rest of the work.
  
  Clinical studies of the early spreading of COVID-19 in the Wuhan region estimate a serial interval between $4$ days \citep{Du2020} and $6$ days \citep{Firth2020}, and a growth rate between $0.1 \ d^{-1}$ \citep{Du2020} and $0.3 \ d^{-1}$ \citep{Sanche2020}. The time and growth scales obtained here are therefore consistent.
  \input{props.tex}  
  
  \subsection{Numerical solutions}
	The time-continuous evolutions of both deterministic models are calculated integrating the differential equations with an ODE solver of the \textit{SciPy} python library (I uploaded all the code at \citet{pyndemic}). 	% TODO Inserire codice in appendice? Release GitHub?
	The complete evolution of the SIR model is shown in Fig. \ref{fig:SIRtot}. It displays all the features discussed analytically in Section \ref{sec:theory}. After a fast initial growth, the number of individuals which simultaneously have the disease reaches a peak of $1900$ ($18.8 \%$ of the total population) on day 18. After $60 \ d$ the total outbreak size $r_{final}$ has reached $85 \%$ and the infected population $i_{final}$ is zero.
	
	The SEIR model instead reaches the peak only on day 41 and the epidemic remains active until day 100. Nevertheless, the peak size and the total outbreak size remain the same. The incubation time has no effect on the magnitude of the epidemic, only on the time scales (at least at this analytical level). These informations are summarized in Tab. \ref{tab:models}. 
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.49\linewidth]{SIR_03.png}
		\includegraphics[width=0.49\linewidth]{SEIR_03.png}
		\caption{Exponential growth in the initial phase of an outbreak for SIR (\textbf{left}) and SEIR (\textbf{right}). }
		\label{fig:BothExp}
	\end{figure}

	The values of the initial growth rates $K_0^{Fit}$ and doubling times $T_d^{Fit}$ are also indicated there. These are not the ones from Tab. \ref{tab:props} predicted analytically, but are estimated by exponentially fitting the incidence time series limited to the initial phase of the outbreak \citep{Bauch2005}, as shown in Fig. \ref{fig:BothExp}.
	 
	The initial part is arbitrarily selected to terminate at $0.16$ of the curve's maximum (epidemic peak) or to include at least 5 readings (from day 0 to day 4). 
	$K_0^{Fit}$ results $0.38 \ d^{-1}$ for the SIR model and  $0.15 \ d^{-1}$ for the SEIR one, in good agreement with the expected values. I will always plot both exponential fits over the positives curve when analysing the initial phase of an outbreak (the predicted in red, the extrapolated in black). 
	\input{models.tex}
	
	The complete evolution of the relative populations of the four compartments of the SEIR model is pictured in Fig. \ref{fig:SEIRboth}, left panel. The delay between the exposed peak and the infected peak is clearly visible. Since the two transition rates $\gamma$ and $\mu$ are equal, the two curves are identical and just shifted in time (otherwise the smaller the rate out, the bigger the relative population).
	\begin{figure}[h]
		\centering
		%  	\includegraphics[width=0.7\linewidth]{SIR_02.png}
		\includegraphics[width=0.49\linewidth]{SEIR_02.png}
		\includegraphics[width=0.49\linewidth]{SEIR_04.png}
		\caption{\textbf{Left}: Typical evolution of a SEIR model. \textbf{Right}: Instantaneous reproduction number }
		\label{fig:SEIRboth}
	\end{figure}

	In the right panel, the same evolution is described by means of the instantaneous reproduction number. The blue line represents the estimate obtained from Eq. \ref{eq:Rt}; the orange line shows instead the result of Eq. \ref{eq:RKt} involving the serial interval and the instantaneous growth rate.  The value of $\tau_s = 4.9 \ d$ is the one calculated analytically for the SEIR model (see Tab. \ref{tab:props}) and will be the same for all the following SEIR simulations.
	The value of $K(t)$ instead is calculated every time step from Eq. \ref{eq:Kt}, where the derivative is performed with second order accurate central differences. The $R = 1$ red dashed line is plotted for reference.

	The initialization of the SEIR model with $i(0) = 0.001$ means that the simulation starts without any incubation delay, thus the instantaneously estimated $R_K(t)$ overshoots the expected value $R(t)$ at the beginning of the simulation. After few days the two estimates are in perfect agreement: the decaying slope is the same and so is the day when $R = 1$ is reached. Later on some discrepancy arises, $R_K(t)$ halting at $0.5$ while $R(t)$ dives a little lower.
 
	%This is the reference framework to which the following simulations are compared.
  
  % Confronto tempi di ricovero/rimozione

  
  \section{Epidemic modelling on complex networks}
  \label{sec:network}
  Homogeneous mixing hypothesis is certainly inadequate when modelling real systems. Human social networks show in fact a structural heterogeneity spanning various scales. Implementing the SEIR model as a diffusion process over a complex network should give more insight in the dynamics characterizing the epidemic spreading in a real environment. Here I will adopt the simplest network representation of the social contacts, i.e. with the nodes representing the individuals and the edges (links) the interactions between them. All edges are here considered equally effective in transmitting the contagion (unweighted network) with probability $\beta$. All nodes share the same incubation and recovery Poisson rates $\gamma$ and $\mu$. 
  
  The epidemic model will be discrete both regarding time (at the $1 d$ scale) and number of cases (at the single individual scale). Edges will be bi-directional (undirected network) because there is no hierarchical or ordering process in influenza-like diseases spreading, apart from a node being already infected or not (but this is the model responsibility, not the network). The network is static in time, meaning that all contacts are supposed to be active for all the time at the daily scale and that neither births nor deaths are considered, as it was for the deterministic continuous models too. 
  
  \subsection{Network models}
  Real-world networks show a small diameter (compared to the number of nodes) but also a high clustering coefficient (high number of 3 vertex cliques) and a connectivity degree distribution spanning several orders of magnitude.
  To move from the homogeneous mixing hypothesis to the similarity to the real world, I will use five different random complex networks models: a perfectly random Erdos-Renyi (ER) network, a ring lattice (RL), a small-world Watts-Strogatz network (WS), a Barabasi-Albert (BA) scale-free network and finally a derivation of BA with increased clustering developed by \citet{Holme} (HK). All the network models except HK are defined and referenced in \citet{PastorSatorras}.
  Fig. \ref{fig:networks0} and Fig. \ref{fig:networks1} show a summary of the network's main features: a representation of the network layout (from a scale model with 1:100 nodes and same average degree), the connectivity histogram ($P(k)$ vs $k$), fitted by a gaussian (red) and a negative power law (blue) distribution.   
  Scatterplots of betweenness centrality against degree ($BC$ vs $k$) are shown to characterize nodes ranking.  Main properties are also reported in the first columns of Tab. \ref{tab:networks}. All networks are connected and share the same number of nodes ($10000$), roughly the same number of edges ($60000$) and the same average connectivity ($\langle k \rangle = 12 = \bar{k}$).
  
  The \textbf{ER} network (Fig. \ref{fig:networks0}, left panel) serves as a null-model for the homogeneous mixing hypothesis. The random long-range connections lead to a low average path length (or small diameter, or high traversability). The node connectivity degree is normally distributed around the mean value (Gaussian red fit). 
  Its more radical counterpart is the \textbf{RL} (Fig. \ref{fig:networks0}, right panel) which describes only small-range (local) interactions. Higher clustering dramatically increases the network diameter. All the node share the same $k$, $C$ and $BC$. 
  
  \textbf{WS} (central panel) is introduced to combine the two pictures together: random "shortcuts" allow a high traversability also in presence of high clustering. All three of them are created through the same Watts-Strogatz algorithm but with different probabilities for the edge random rewiring: $1$ for ER, $0$ for RL and $0.1$ for WS.
  
  
  Up to here, the average connectivity degree $\langle k \rangle$ still defines a precise scale for all the network properties. \textbf{BA} instead (Fig. \ref{fig:networks1}, left) introduces a connectivity distribution which extends over multiple orders of magnitude (scale-free in the limit of a continuously incrementing size), following a negative power law. But BA lacks again in clustering. 
 
  There are many models that try to extend BA toward a higher clustering and realistic growing dynamics, \textbf{HK} is chosen among them because it provides tunable clustering (here set at the maximum possible value of $1$) and because it is already integrated in the NetworkX library. The presence of clustering in HK is obtained by building a triangle after each step of preferential attachment of the BA algorithm \citep{Holme}.
  HK is presented in Fig. \ref{fig:networks1}, central panel. Writing the scale-free distribution as: $P(k) \approx k^{- \gamma}$, BA and HK have respectively $\gamma = 2.68$ and $\gamma = 2.70$.
  The right panel of Fig. \ref{fig:networks1} refers instead to a HK copy where the highest BC nodes have been removed (HKL) and it is addressed in Sec. \ref{sec:miti}.
  
  
  \subsection{The DBMF approach} 
  The predictions of Sec. \ref{sec:theory} are obtained replacing $\bar{k}$ with $\langle k \rangle$ (homogeneous mixing hypothesis). But the deterministic epidemic equations could be adapted to the network representation also substituting the average number of contacts $\bar{k}$ with each node's connectivity degree $k$. Nodes with different connectivity are now treated differently by the model's equations.
  
  Assuming that all the nodes with the same $k$ could be considered statistically equivalent and share the same probability $P(k'|k)$ to be connected to any node of degree $k'$, a possible solution is to re-write the set of deterministic differential equations (Eq. \ref{eq:seir}) for each degree class separately.
  In this way, the homogeneous hypothesis is moved from the total population to the single k classes (k-stratification): the actual topology of the network is not yet taken into account, but at least the degree distribution is. 
  
  The deterministic differential equations are stratified for each degree and the evolution of the overall compartments is given by the sum of all the k-specific compartments. The $i$ and $r$ equations remain identical at the $k$ level, since the incubation and removal processes evolve for each node independently from the others. The contagion process instead is based on the encounter between two populations without any constraint on degree, therefore it needs a proper degree-mixing term $\Gamma_k$ to be added to the equations. It controls the $s_k \cdot i_k'$ product in the $s(t)$ and $e(t)$ equations and grants that each $k$ susceptible class encounters every $k'$ infected class with the $P(k'|k)$ probability:
  \begin{align}
  	\diff{s_{k}}{t} = - \beta k s_{k} \Gamma_{k} \quad;  \qquad 	\diff{e_{k}}{t} =  \gamma e_{k} \ - \ \beta k s_{k} \Gamma_{k} \quad; \qquad	\Gamma_{k} = \sum_{k'} \ P(k'|k) \ i_{k'}  \ \frac{k' - 1}{k}
  	%  	\quad; \qquad \diff{i_{k}}{t} = \gamma e_{k} - \mu i_{k} \quad; \qquad \diff{r_{k}}{t} = \mu i_{k}
  	\label{eq:seir_dbmf}
  \end{align}
%  \begin{align}
%  	\Gamma_{k} = \sum_{k'} \ P(k'|k) \ i_{k'}  \ \frac{k' - 1}{k}
%  	\label{eq:mixing}
%  \end{align}
%  
  The coefficient $\frac{k' - 1}{k'}$ takes into account the fact that, in a static network, a node could not propagate the disease to the neighbour who originally infected it, because the latter is necessarily not susceptible. This node has to be ignored when calculating the actual probability of finding one susceptible neighbour among the $k'$ connected ones.
  
  The coefficient corrects also the connectivity matrix $\tilde{C}$, whose elements are:  
  \begin{align}
		\tilde{C}_{kk'} = k \ P(k'|k) \ \frac{k' - 1}{k'} + \epsilon
  \end{align}

	where $\epsilon$ is a very small quantity ($10^{-10}$) introduced to complete the k-spectrum in case of missing values of $k$. The effect on the results is negligible at the considered precision (since one individual is $ \sfrac{1}{N} = 10^{-4} \ , \ 0.1 \%$) but it allows the inversion of the matrix without singularities.

  The inverse of the largest eigenvalue $\Lambda_M$ of the matrix $\tilde{C}$ defines the epidemic threshold for the spreading rate $\sfrac{\beta}{\mu}$ over the network. Both the epidemic threshold and the spreading rate are here multiplied by the average connectivity $\bar{k} = 12$, so that the control parameter becomes $\sfrac{\lambda}{\mu}$ at the start and $R(t)$ as the epidemic evolves. The critical value for this is $1$ in the deterministic solution, as seen in Eq. \ref{eq:sir_growthReq}, and it is $\sfrac{\langle k \rangle}{\Lambda_M}$ in the DBMF approximation over the network. This means that if the critical value is larger (resp. smaller) than one, the network topology itself is inhibiting (resp. favouring) the spreading of the disease compared to the deterministic case. $R_K(t)$ instead, being calculated on actual increments of the number of positive (infected) individuals, still has $1$ as fixed critical value.
  \begin{align}
		 R(t) \equiv \frac{\beta \langle k \rangle }{\mu} \cdot s(t) \ > \ \frac{\langle k \rangle}{\Lambda_M}
  \end{align}
  
  The DBMF approach allows also to predict the actual initial exponential growth as fuelled (or dampened) by the network structure. The k-stratified version of Eq. \ref{eq:seir_approxi} is:
  \begin{align}
    	\diff{}{t}
	  \begin{pmatrix}
	  	e_k \\
	  	i_k
	  \end{pmatrix}_{t=0}
	  \approx \
	  \begin{pmatrix}
	  	- \gamma & \beta \Lambda_M s_{0,k} \\
	  	\gamma & - \mu
	  \end{pmatrix}
	  \begin{pmatrix}
	  	e_k \\
	  	i_k
	  \end{pmatrix}
	  \quad = \quad K_0 %^{SEIR}
	  \begin{pmatrix}
	  	e_k \\
	  	i_k
	  \end{pmatrix} %> 0
	  \label{eq:seir_approxiDBMF}
  \end{align}
  
  For uncorrelated networks, the largest eigenvalue $\Lambda_M$ could be approximated by:
  \begin{align}
  	\Lambda_M^{uncorr.} \approx \frac{\langle k^2 \rangle}{\langle k \rangle} - 1
  \end{align}

  where $\langle k^2 \rangle = \sum_k k^2 P(k)$ is the un-normalized second moment of the degree distribution and $- 1$ derives from the $\frac{k-1}{k}$ correction.
  The predicted values of $K_0$ and the critical threshold are presented in pairs in the last two columns of Tab. \ref{tab:networks}, firstly the one obtained from $\Lambda_M$, then the approximated value for uncorrelated networks. Only for disassortative networks like BA and HK there are differences between the two estimates. 
 	\input{networks.tex}
  

  \clearpage
  \begin{figure}[h!]
  	\centering
  	\includegraphics[width=0.33\linewidth]{random_00.png}
  	\includegraphics[width=0.33\linewidth]{smallw_00.png}
  	\includegraphics[width=0.33\linewidth]{lattice_00.png}
  	
  	\includegraphics[width=0.33\linewidth]{random_01.png}
  	\includegraphics[width=0.33\linewidth]{smallw_01.png}
  	\includegraphics[width=0.33\linewidth]{lattice_01.png}
  	\caption{Network presentation [1/2]: ER, WS and RL.}
  	\label{fig:networks0}
  \end{figure}  	
  
  \begin{figure}[h!]
  	\centering
  	\includegraphics[width=0.33\linewidth]{random_02.png}
  	\includegraphics[width=0.33\linewidth]{smallw_02.png}
  	\includegraphics[width=0.33\linewidth]{lattice_02.png}
  	
  	\includegraphics[width=0.33\linewidth]{random_03.png}
  	\includegraphics[width=0.33\linewidth]{smallw_03.png}
  	\includegraphics[width=0.33\linewidth]{15_beforeDBMF/lattice_03.png}
  	
  	\includegraphics[width=0.33\linewidth]{random_04.png}
  	\includegraphics[width=0.33\linewidth]{smallw_04.png}
  	\includegraphics[width=0.33\linewidth]{lattice_04.png}
  	
  	\caption{Evolution of the epidemic models ensemble over different complex networks [1/2].}
  	\label{fig:outcomes0}
  \end{figure}
  \clearpage

  
  \subsection{Simulations over networks}
  Simulations are run in batches of $100$ per network type, to create an ensemble of random initial statuses and random infection patterns, while the network structures are maintained fixed (setting a seed in the random network generator functions). The evolution of the relative population of the four compartments is presented in the top row of Fig. \ref{fig:outcomes0} and \ref{fig:outcomes1}, following the same column arrangement of Fig. \ref{fig:networks0} and Fig. \ref{fig:networks1}. In the middle row a detail of the initial phase is shown (the axes are rescaled consistently). The evolution of the effective reproduction number is represented in the bottom row for the whole duration. The daily median of the considered variables (relative population of the compartments, K(t), R(t)) is extracted from the ensembles and reported in Tab. \ref{tab:results} and plotted as a solid line. Soft coloured areas display the total spread within the ensembles.
  \input{results.tex}
  
  \subsection{Results and discussion}
%  \subsubsection{ER} %subsub
  The epidemic simulation over the random network null model \textbf{ER} (Fig. \ref{fig:outcomes0}, top left) is in very good agreement with the deterministic result: most of the population ($80 \%$) is reached by the epidemic in around $100 \ d$, with the peak in the number of positives reaching $14 \%$ and happening around day $50$. The coupling of the randomness in the connectivity patterns, in the choice of the initially infected nodes and in the Markov chain of the contagion process produce some variance. Its effects are limited to the middle phase and are of limited magnitude. All the members of the ensemble converge pretty firmly to the same value of prevalence (0.70) and have similar transmission speeds (i.e. steepness of the blue (s) and red (r) curves). Most of the variability seems to originate from the initial phase.
  
  Initial growth is slightly slower than both deterministic and DBMF predictions, with the former serving almost as an upper bound for the growth rate of the random ensemble (the red dashed line of Fig. \ref{fig:outcomes0}, middle left, is in fact at the edge of the grey area, which is the range of growth rates fitted on the members). Consistently, the actual $R_K(t)$ (orange solid line of Fig. \ref{fig:outcomes0}, bottom left) remains under the $R(t)$ predicted from the availability of susceptible individuals (blue solid line). $R(t)$ analysis confirms the agreement between expectations and simulation in the middle and final phases: both lines cross the critical value (one) at the same time (peak day) and die out almost the same way.
  
  The $R_K(t)$ estimate becomes noisy at the start and at the end of the epidemic because $K(t)$ is normalized with the number of positives.
  The small density of the first and last cases increase the relative weight of the random fluctuations and of the numerical noise. From here arises also the uncertainty in the $R(t)$ determination at the start of an outbreak in real life.\\
  
  %  \subsubsection{WS}
  Looking at the epidemic over \textbf{WS} (Fig. \ref{fig:outcomes0}, central column), the initial growth is slower ($- 58 \%$) and the peak of positives (exposed + infected) is $65 \%$ smaller and happens $45$ days later ($+ 94 \%$). DBMF estimates for WS and ER are nearly identical: DBMF clearly does not spot the presence of higher clustering, since the connectivity matrix carries no information about that, but the dynamic of the spreading appears to be highly influenced by that.
  
  %  \subsubsection{RL}
  In the \textbf{RL} the phenomenon is even more evident and dominates the spreading dynamic completely after just a week and $20$ cases. The contagion is strongly inhibited by the fast depletion of nearby susceptible nodes. The drop in the number of total susceptible individuals (s) is barely noticeable (Fig. \ref{fig:outcomes0}, bottom right), still R(t) rapidly drops around $1$. The local picture overcomes the global one, the epidemic dies out even if there is plenty of nodes still susceptible. For the other network models $\langle l \rangle$ is of the same order of magnitude of $\tau_r = 3 \ d$, for RL is more than 100 times smaller (contagion speed along the paths is $\leq \ \gamma = 0.33 \ \sfrac{edges}{day}$).
  The contagion probably spreads like a progressing front (like fire on a sheet of paper), as $R_K(t)$ near one suggests, without increasing the population of positives over just 34 individuals. It stops when random fluctuations deplete the number of positives.\\
  
  Scale free networks \textbf{BA} and \textbf{HK} (Fig. \ref{fig:outcomes1}, first and second column) show a much faster spreading of the infection ($K_0$ $+ 140 \%$, peak $- 50 \%$ with respect to ER). Apart from HK reaching a slightly lower peak ($- 20 \%$ with respect to BA), the two share the same development of the epidemic.
  I have no direct insight of the node-by-node evolution of the spreading, but it is much reasonable to expect that the first phase of the outbreak involves the hubs of the network. They are always pretty close to any node chosen at random (as the initial infected seed is) due to their high BC, so they are likely to be infected in the early stages, and they have a high connectivity degree, which gives them a great infecting potential. Hub nodes could be related to the super-spreaders individuals detected in real-life scenarios \citep{Kissler2018}, even though in the clinical studies the direct relation between high connectivity and the super-spreading role does not always occur and more variables come into play. % Ref. Haslemere for time scale of super-spreading events
  
  In the second phase, all major hubs have probably been reached by the infection already and they recovered, hindering the diffusion between the remaining low-degree still-susceptible nodes. Thus, despite the explosive outbreak, the final prevalence is slightly smaller than the uncorrelated networks' ($- 11 \%$).
  
  Here, the DBMF estimate of the growth rate (the one estimated through the moments of the degree distribution) and the deterministic one (form Eq. \ref{eq:seir_K0}) are respectively the upper and lower boundary for the spread of the ensemble's growth rates (for ER instead, the deterministic was the upper boundary). DBMF prediction derived from $\Lambda_M$ is even bigger and it is not plotted. 
  
   % vanishing thresholds
  Theory predicts a vanishing epidemic threshold for scale-free networks with a negative exponent between $-2$ and $-3$ (as BA and HK) in the limit of $N \rightarrow \infty$ \citep{PastorSatorras}. Here, $N=10000$ put the simulation quite far from that limit, but still the DBMF prediction of the critical value for $R(t)$ drops under $0.5$. The value is probably underestimated since $R(t)$ plateaued higher than that level. Nevertheless, it is an opposite behaviour to what was seen for ER, where instead the network structure slightly opposed the spreading.
  

  
  % TODO commento e intro a HK Lockdown.
  
  \clearpage
  
  \begin{figure}[h!]
  	\centering
  	\includegraphics[width=0.33\linewidth]{scalefree_00.png}
  	\includegraphics[width=0.33\linewidth]{realw_00.png}
  	\includegraphics[width=0.33\linewidth]{lockHiBC_connected_00.png}
  	
  	\includegraphics[width=0.33\linewidth]{scalefree_01.png}
  	\includegraphics[width=0.33\linewidth]{realw_01.png}
  	\includegraphics[width=0.33\linewidth]{lockHiBC_connected_01.png}
  	\caption{Network presentation [2/2]: BA, HK and HKL.}
  	\label{fig:networks1}
  \end{figure}  	
  
  \begin{figure}[h!]
  	\centering 
  	%	 	\footnotesize
  	%  	a \includegraphics[width=0.3\linewidth]{scalefree_02.png}
  	%  	b \includegraphics[width=0.3\linewidth]{realw_02.png}
  	%  	c \includegraphics[width=0.3\linewidth]{lockHiBC_connected_02.png}
  	%  	
  	%  	d \includegraphics[width=0.3\linewidth]{scalefree_03.png}
  	%  	e \includegraphics[width=0.3\linewidth]{realw_03.png}
  	%  	f \includegraphics[width=0.3\linewidth]{lockHiBC_connected_03.png}
  	%  	
  	%  	g \includegraphics[width=0.3\linewidth]{scalefree_04.png}
  	%  	h \includegraphics[width=0.3\linewidth]{realw_04.png}
  	%  	i \includegraphics[width=0.3\linewidth]{lockHiBC_connected_04.png}
  	
  	\includegraphics[width=0.33\linewidth]{scalefree_02.png}
  	\includegraphics[width=0.33\linewidth]{realw_02.png}
  	\includegraphics[width=0.33\linewidth]{lockHiBC_connected_02.png}
  	
  	\includegraphics[width=0.33\linewidth]{scalefree_03.png}
  	\includegraphics[width=0.33\linewidth]{realw_03.png}
  	\includegraphics[width=0.33\linewidth]{lockHiBC_connected_03.png}
  	
  	\includegraphics[width=0.33\linewidth]{scalefree_04.png}
  	\includegraphics[width=0.33\linewidth]{realw_04.png}
  	\includegraphics[width=0.33\linewidth]{lockHiBC_connected_04.png}
  	
  	\caption{Evolution of the epidemic models ensemble over different complex networks [2/2].}
  	\label{fig:outcomes1}
  \end{figure}
  \clearpage
 
  
  % Discussion on clustering
  Peak data (day vs size) for all the runs of the models is summarized in the scatterplot of Fig. \ref{fig:analysis}, left panel. Looking at the ER-WS and BA-HK data points, the increased clustering clearly limits the peak size, more evidently for the uncorrelated ER-WS pair but detectable also for BA-HK. Peak day instead is heavily delayed in WS, unchanged in HK: disassortativity seem to control the timing of the spreading much more than clustering. Clustering instead, when not coupled with disassortativity, remarkably emphasizes the randomness in the peak's timing (WS and RL), while its magnitude has much lower variance.
  
  According to the literature, the clustering should also limit the outbreak size \citep{PastorSatorras}: this is found to be true for RL and WS, but seems to become less evident when clustering is coupled with scale-freeness in HK (see Fig. \ref{fig:analysis}, right panel: correlated fit (pink) vs uncorrelated (grey)). 
  Clustering could also intuitively give an initial boost to the outbreak speed at the very local scale, but no confirmation of that emerges from the data.
  

	\begin{figure}[h]
		\centering
		%  	\includegraphics[width=0.7\linewidth]{SIR_02.png}
		\includegraphics[width=0.49\linewidth]{analysis_Peak.png}
		\includegraphics[width=0.49\linewidth]{analysis_Size.png}
		\caption{\textbf{Left}: Peak size against peak day. % for all considered networks.
			\textbf{Right}: Outbreak size against average node clustering coefficient (RL and HKL are omitted here) with pairwise linear fit.}
		\label{fig:analysis}
	\end{figure}
  

	\section{Mitigation effort}
	\label{sec:miti}
	%%	
	%%	Rescaling of beta, rescaling of s(t)
	%%	
	%%	Sim? 
	%%	- non awareness mode
	%%	- immunization before init
	%%	. random
	%%	. targeted
	%%	
	%
	%	
	%	A delay in the hospitalization affects $R_0$ directly and with great potential: $R_0$ is proportional to the delay $\tau_{r}$ between the onset of the contagiousness and the beginning of the isolation measurements (Eq. \ref{eq:R0}). Changing $\tau_{r}$ from $3$ to $7 \ d$, as assumed for the "non-awareness mode" in the initial phase of the COVID-19 outbreak, results in $R_0$ greater than $5$.
	%	% numbers? fare simulazioni?
	%	
	%	\subsection{Vaccines}
	%	Complete removal of the susceptible individuals is not needed to stop an epidemic. Herd immunity triggers by definition as $R(t)$ reaches $1$. This could be obtained naturally during the epidemic evolution or by vaccination of part of the susceptible population.
	%	
	%	The number $g = 1 - \sfrac{1}{R_0} $ identifies the fraction of susceptible population which needs to be vaccinated in order to reach herd immunity.
	%	The remaining susceptible population is given by $1 - g = \sfrac{1}{R_0} = 0.46$.
	%	% come scalare col critcal value?
	%	
	%	This value could be compared with the value of $s_peak$ (Tab. \ref{tab:results}), which is the actual fraction of individuals still susceptible the day the positives reach the peak. The farther the two numbers are, the more the network influences the immunity dynamics. ER is not surprisingly the closer to the deterministic well-mixed picture. RL is the one that departs the most. BA and HK probably have the super-spreading hubs already infected by the day of the peak, so probably $1 - s_peak$ is not a good estimate for the herd immunity in a network like that (it should be much higher, with $s_peak$ smaller). 

	Waiting for a vaccine, mitigation measures should be taken from governments and authorities to slow down the disease spreading in order to keep the positives peak under the level of maximum capacity of the national health care systems. 
	In heterogeneous disassortative networks, early hospitalization and targeted lock-downs seem to be the most effective strategies, especially when combined. I will not address contact tracing here, since the topology of the contacts network is assumed known. 
	
	\subsection{Targeted lockdown}
	Lockdowns could be random (everybody stays at home) or targeted (places and events with the greatest risk of contagion are closed). I simulated a targeted lockdown scenario by attacking the network's nodes ranked by a centrality metric. This was chosen to be the betweenness centrality (BC), in order to hit the superspreading role of the high BC hubs explored in the previous Section.
	
	After reaching the threshold level of 400 positives ($p(t) = 0.04$) over an unmodified HK network, nodes with high BC are recursively removed until a the resulting average connectivity degree is reduced by $ 40 \%$. These values are an arbitrary choice that balances the value of the resulting $R_0$ ($1.32$), the network size and the mitigation effectiveness.
	In this way, only a small fraction of the nodes is completely isolated ($6 \%$), but half of the connections is inhibited. Clustering remains reasonably high and the average connectivity around $7$ means that most personal relations are still allowed. The network is still connected.
	
	From day 14 the epidemic model is run on this variant of the HK network (HKL). Relative populations are rescaled to the new total number of nodes, so there is a small gap in the curves of Fig. \ref{fig:outcomes1}, top right.
	
	\begin{table}[h]
		\centering
		\caption{Networks properties. $\langle k \rangle$ and $\langle C \rangle$ are the average node connectivity degree and the average clustering coefficient respectively. }
		\label{tab:lock_networks}
		\begin{tabular}{lccccccc}
			\toprule
			Network &  Edges &  Nodes & $\langle k \rangle$ & $\langle C \rangle$ & $\langle l \rangle$ & $K_0^{DBMF}$ $(d^{-1})$ & Crit. value \\
			\midrule
			Holme-Kim 		&  59963 &  10000 & 11.99 &  0.38 &  3.98 &  0.58 / 3.10 &   0.29 / 0.02 \\ 
			High BC lock.	&  33717 &   9363 &  7.20 &  0.28 &  7.36 &  0.08 / 0.07 &   0.86 / 0.87 \\
			
			\bottomrule
		\end{tabular}
	\end{table}
	
	Looking at the plot, the first thing that catches the eye is the  greatly increased spread between the members of the simulation (Fig. \ref{fig:outcomes1}, top right). This is probably due to technical reasons and it is not a direct consequence of the network modification: going from the unmodified HK to HKL, the epidemic model is unfortunately reinitialized from scratch. Each new member of the ensemble inherits the correct relative population of the compartments, but the information about the single node belonging which compartment is lost (this is equivalent to a node-edges reshuffle). Therefore a new source of variability is introduced and its role appears dominant. Tackling this issue was beyond the reach of this work (some intervention inside the NDlib code would have been needed) and nevertheless some reshuffling of the social interactions following a change in the daily routines (caused by the partial lockdown) is also reasonable.
	
	Apart from the increased spread, the effects of the "lockdown" are clearly visible in terms of the sudden drop in the positives curve's steepness (from day $14$), hence in the speed of the spreading. The peak day follows closely (day $25$) and is much lower than without the lockdown ($- 70 \%$). But after that, since the susceptible compartment remains highly populated, the epidemic still takes a long time before dying out ($+ 32 \ d$ with respect to HK).\\
	
	- Variability in both peak day and peak intensity (Fig \ref{fig:analysis})
	
  - inverse correlation between peak day and size	 
  
 	- final prevalence is also halved
 	
% 	\begin{figure}[h]
%		\centering
%		%  	\includegraphics[width=0.7\linewidth]{SIR_02.png}
%		\includegraphics[width=0.49\linewidth]{SEIR_02lockdown2.png}
%		\includegraphics[width=0.49\linewidth]{SEIR_03lockdown2.png}
%		\caption{\textbf{Left}: Evolution of a SEIR model with simulated lockdown. \textbf{Right}: Initial growth }
%		\label{fig:SEIRlock}
%	\end{figure}
	\begin{table}[h]
		\centering
		\caption{Summary of the numerical simulations over networks. The indicated values represent the median from 100 simulations.}
		\label{tab:lock_results}
		\begin{tabular}{lcccccccc}
			\toprule
			%   Model & $K_0^{Fit}$ $(d^{-1})$ & $T_d^{Fit}$ $(d)$ & $i_{end}$ & $r_{end}$ & End day $(\#)$ & Peak $(\%)$ & Peak day $(\#)$ \\
			Network model & $K_0^{Fit}$ $(d^{-1})$ & $T_d^{Fit}$ $(d)$ & $i_{end}$ & $r_{end}$ & End day & Peak  & Peak day & $s_{peak}$\\
			\midrule
			Holme-Kim 		&    0.28 &   2.51 &  0.00 &  0.70 &  	 86 &  0.17 &   27 &	0.59 \\
			High BC lock.	&    0.28 &   2.44 &  0.00 &  0.35 & 		132 &  0.05 &   25 &	0.78 \\
			Late hospit.  & 	 0.32 &   2.18 &  0.00 &  0.94 &     97 &  0.40 &   26 &  0.31 \\
			
			\bottomrule
		\end{tabular}
	\end{table}
	
	
	\subsection{Early vs late hospitalization}
	The simulations of Sec. \ref{sec:network} already adopted the best-case scenario for the removal/recovery time ($\tau_{r} = 3 \ d$), assuming a fast diagnosis and isolation of the infected cases. 
	Otherwise, a delay in the hospitalization would affect $R_0$ directly and with great potential (see Eq. \ref{eq:R0}). Changing $\tau_{r}$ from $3$ to $7 \ d$, as assumed for the "non-awareness mode" in the initial phase of the COVID-19 outbreak, results in $R_0$ greater than $5$. Even if the initial growth over HK develops at almost the same speed ($K^{Fit}_0 = 0.32$, peak day: $26$), the long-lasting contagiousness effects show up in the middle phase and make the peak rise to $40 \%$ (4000 individuals), leading to a shocking final prevalence of $94 \%$ (see Tab. \ref{tab:lock_results}). 
	
	
	\section{Conclusions}
	The intention was to recreate the same analysis work flow of the deterministic models and see if, and under which conditions, the deterministic prediction works as mean field approximation and where instead is overcome by new results. 

	More advanced approaches based on open-source real data, like the one described in \citet{Firth2020}, exploit a variable weighted and directed network topology that follows the actual interactions of a group of people during the day on a short time scale, greatly increasing the complexity and computational load of the simulations.


 
%	\section*{Appendix}
%		
%  \scriptsize 
%  \footnotesize
	\clearpage
	\small
	\bibliographystyle{plainnat} %  % apalike
	% Apalike non mostra i DOI, plainnat o abbrvnat mettono i nomi prima dei cognomi
	\bibliography{networks}

\end{document}



%%% Vademecum %%%
Bibliography:
\bibliographystyle{plainnat} %  % apalike
% Apalike non mostra i DOI, plainnat o abbrvnat mettono i nomi prima dei cognomi
\bibliography{networks}

Citations:
\citep{bibid}
\citet{bibid}

Math expressions:
\begin{align}
	a = b
\end{align}

Tables:
\begin{table}[h]
	\centering
	\begin{tabu} to \textwidth {X[1,l]X[1,c]X[1,c]X[1,c]} 
		\toprule
		Product & Reference  & Latency  & Spatial \\
		&time step (min)  &  (min)  &   resolution (km) \\ 
		\midrule
		CML & 15 &20 & 5 \\
		Radar raw & 5 & 15 & 1 \\
		Radar adj. & 60 & 60 &  1 \\
		Raingauges raw & 60 & 60 &  - \\
		ERG5 & 60 & 1440 & 5 \\ 
		\bottomrule
	\end{tabu}
	\caption{Latency and spatial and temporal sampling of the considered precipitation products.}
	\label{tab:latency}
\end{table}

Figures:
\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.75\linewidth]{../Es01/immagini/dati4.png}
	\caption{Portate in funzione dei tiranti per le 4 campagne di misura, con incertezze al 25\%.}
	\label{fig:dati}
\end{figure}
